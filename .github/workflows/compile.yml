name: Compile

on:
  push:
    branches:
      - main

jobs:
  compile:
    runs-on: self-hosted
    # environment: compile
    steps:
    - name: Checkout code
      uses: actions/checkout@v4 
    env:
      DESTINATION_DIR: "/services/cross-chain-meme-creator-backend"

    - name: Install dependencies & build
      run: | 
        npm install
        npn run build

    - name: Create new directory & copy files
      run: |
        mkdir -p -r $DESTINATION_DIR
      
        mkdir -p  $DESTINATION_DIR/dist
        copy -r /dist  $DESTINATION_DIR/dist
